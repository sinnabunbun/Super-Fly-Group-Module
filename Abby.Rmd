---
title: "Abby"
author: "Abby"
date: "11/5/2021"
output: html_document
---

```{r}
library(ape)
library(fastmatch)
library(quadprog)
library(phangorn)
library(phytools)
library(geiger)
library(ggplot2)
library(ggtree)
```

```{r}
mol.tree<-read.nexus(file="NJst.tre")
mol.tree
```

Once the tree is loaded, we can try plotting it! 

```{r}
par(mfrow = c(2, 3))
phy <- plot(mol.tree, type = "phylogram",  edge.color = "purple", font = 1, show.tip.label = FALSE)
phy

unroot <- plot(unroot(mol.tree),type="unrooted",cex=0.6,
    use.edge.length=FALSE,lab4ut="axial",
    no.margin=TRUE, show.tip.label = FALSE, edge.color = "red")
unroot

radial <- plot(mol.tree, type = "radial",  edge.color = "green", tip.color = "black", font = 1, show.tip.label = FALSE)
radial

fan <- plot(mol.tree, type = "fan",  edge.color = "blue", tip.color = "black", font = 1, show.tip.label = FALSE)
fan

clade <- plot(mol.tree, type = "cladogram",  edge.color = "orange", tip.color = "black", font = 1, show.tip.label = FALSE)
clade
```

the Ntip() function will tell you how many different species (or tips) are represented in your tree 

```{r}
Ntip(mol.tree) ##66 species in this tree
```

To generate a list of species names, use mol.tree$tip.label

```{r}
##all the species names 
mol.tree$tip.label
```

##CHALLENGE 4 
A great way to draw attention to a specific species in a tree plot is to add an arrow pointing to a specific species. Now that you can see all the species names, pick a species and use add.arrow() to draw an arrow to it! 

###SOLUTION 4
```{r}
##add an arrow on a specific branch tip 
plot(mol.tree)
add.arrow(mol.tree,tip="A_saundersii_saundersii",arrl=4)
```
With nexus trees, you can also create node labels. This is especially useful if you want to highlight a specific node. 

```{r}
plot(mol.tree,no.margin=TRUE,edge.width=2)
nodelabels(text=1:mol.tree$Nnode,node=1:mol.tree$Nnode+Ntip(mol.tree))
```

```{r}
plot(mol.tree, "fan", main="Molecular Tree", edge.width = 3, edge.color = "pink", show.tip.label = FALSE)
arc.cladelabels(tree=mol.tree, "A. rothschildi", node = 4, cex=1, orientation="curved")
```


#Morphological Tree

In order to compare molecular and morphological trees of the Adelpha lineage, we needed to build a tree in R from a phylogeny constructed based on morphological data, like the one reported in Keith Wilmott's paper. However, because this tree was created in 2003 and is therefore not in a format that is easily compatible with current R software, we ended up transcribing the tree into R in Newick format based on the phylogenetic relationships presented in Wilmott's Figure 8. 

```{r}
string <- "((A_alala_negra, A_corcyra_aretina, A_tracta, A_pithys, A_donysa_donysa), ((A_serpacelerio, A_seriphiaaquillia, A_seriphiatherasia), (A_melonaleucocoma, A_salmoneus_colada, A_cytherea_cytherea, A_cythereadaguana, A_epioneagilla, A_etheldaethelda, A_thessaliathessalia, A_iphicleolathessalita, A_iphiclusiphiclus, A_shuara, A_plesaurephliassa, A_basiloides, A_atticaattica, A_leucerioides, A_saundersiisaundersii, A_boreasboreas, A_rothschildi, A_sichaeus, A_cocalacocala, A_leucophthalmairminella, A_irminatumida, A_pollina, A_lycoriaslara, A_lycoriasspruceana, A_erotia_erotia, A_mesentina, A_phylaca_pseudaethalia, A_capucinus_capucinus, A_heraclea_heraclea, A_naxia_naxia, A_justina_valentina, A_olynthia, A_jordani, A_zinazina, A_zinairma, A_delinita_delinita, A_boeotia_boeotia, A_maleaaethalia)));"

morph.tree<-read.tree(text=string)
plot(morph.tree,no.margin=TRUE,edge.width=2)
```
```{r}
par(mfrow = c(2, 3))
phy2 <- plot(morph.tree, type = "phylogram",  edge.color = "purple", font = 1, show.tip.label = FALSE)
phy2

unroot2 <- plot(unroot(morph.tree),type="unrooted",cex=0.6,
    use.edge.length=FALSE,lab4ut="axial",
    no.margin=TRUE, show.tip.label = FALSE, edge.color = "red")
unroot2

radial2 <- plot(morph.tree, type = "radial",  edge.color = "green", tip.color = "black", font = 1, show.tip.label = FALSE)
radial2

fan2 <- plot(morph.tree, type = "fan",  edge.color = "blue", tip.color = "black", font = 1, show.tip.label = FALSE)
fan2

clade2 <- plot(morph.tree, type = "cladogram",  edge.color = "orange", tip.color = "black", font = 1, show.tip.label = FALSE)
clade2
```


#ggtree

You can also plot these trees using the ggplot2 and ggtree packages 

```{r}
#Morphological tree plot
library(ggtree)
p <- ggtree(morph.tree, color="purple", size=0.5)
p <- p + geom_tiplab(size=2)
p
```

```{r}
#Molecular tree plot 
g <- ggtree(mol.tree, color="green", size=0.5)
g <- g + geom_tiplab(size=2)
g
```

```{r}
library("gridExtra")
grid.arrange(
    ggtree(mol.tree, color="red") + theme_tree("steelblue"),
    ggtree(morph.tree, color="white") + theme_tree("black"),
    ncol=2)
```
